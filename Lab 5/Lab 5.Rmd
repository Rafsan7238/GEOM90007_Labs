---
title: "Lab 5"
output: html_notebook
---

Load Data

```{r}
auMap <- readOGR(dsn="IV-lab-5-data-new/SpatialData/AusStates.shp")
```

```{r}
class(auMap)
```

Plot Map with rgdal

```{r}
plot(auMap)
```

Map Conversion

```{r}
auMapDf <- fortify(auMap)
```

Plot Map

```{r}
ggplot(auMapDf) + aes(long, lat, group=group) + geom_polygon()
```

Pre-Lab 1

```{r}
auBirth <- read.csv("IV-lab-5-data-new/Births_summary_with_id.csv", stringsAsFactors = FALSE)
```

```{r}
ggplot(auBirth) + aes(x=Region, y=X2017) +
  geom_bar(stat="identity")
```

```{r}
# Convert data to long format for multiple data series (2017-2020)
auBirth_long <- pivot_longer(auBirth, cols = starts_with("X"), names_to = "Year", values_to = "Births")

# Sort the data by Births in descending order
auBirth_long <- auBirth_long[order(-auBirth_long$Births),]

# Create a custom color palette
my_colors <- c("#1f77b4", "#ff7f0e", "#2ca02c", "#d62728")
```

```{r}
# Plot a horizontal bar chart with additional customizations
ggplot(auBirth_long, aes(x = Births, y = Region, fill = Year)) +
  geom_bar(stat = "identity", position = "dodge") +
  scale_fill_manual(values = my_colors) +
  labs(title = "Births by Region in Australia (2017-2020)",
       x = "Number of Births",
       y = "Region") +
  theme_minimal() +
  theme(legend.position = "top") +
  guides(fill = guide_legend(title = "Year"))
```

Pre-Lab 2

```{r}
auBirth_long_new <- auBirth %>% gather(key=Year, value=Births, -Region, -id)
```
